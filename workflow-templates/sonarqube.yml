
# Generic workflow for usage of SonarQube with Bayer SonarQube
# Maintainer: Tim Jonas Meinerzhagen (GHXAX)
#
# Prerequisites: Needs SONAR_TOKEN to be present in Secrets Environemnt

name: SonarQube
on:
  workflow_dispatch:
  push:
  pull_request:

jobs:
  sonarqube:
    name: SonarQube
    runs-on: self-hosted

    steps:
      - name: cleanup permissions #https://github.com/actions/checkout/issues/273
        run: sudo chown -R $USER:$USER $GITHUB_WORKSPACE
      - uses: actions/checkout@v2
      - name: SonarQube Scan
        uses: kitabisa/sonarqube-action@v1.0.1
        with:
          host: "https://sonar-github.cloud.bayer.com"
          login: ${{ secrets.SONAR_TOKEN }}